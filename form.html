<form id="expenseForm">
  <label>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:
    <select id="item">
      <option>‡∏ó‡∏∏‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
      <option>‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏ó‡∏∏‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÅ‡∏Å‡∏∞‡πÅ‡∏•‡πâ‡∏ß</option>
    </select>
  </label><br><br>

  <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô:
    <input type="number" id="amount" required>
  </label><br><br>

  <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:
    <select id="category">
      <option>‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</option>
      <option>‡πÇ‡∏≠‡∏ô</option>
      <option>‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
    </select>
  </label><br><br>

  <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:
    <input type="text" id="note" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏à‡∏≥, ‡∏™‡πà‡∏á Grab">
  </label><br><br>

  <button type="submit">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
</form>

<p style="margin-top:40px;">
  üîô <a href="index.html">‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</a>
</p>

<script>
  document.getElementById('expenseForm').addEventListener('submit', async (e) => {
    e.preventDefault();

    const amount = document.getElementById('amount').value;
    const category = document.getElementById('category').value;

    const data = {
      item: document.getElementById('item').value,
      amount: amount,
      category: category,
      note: document.getElementById('note').value,
      date: new Date().toISOString()
    };

    const response = await fetch('/save', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    });

    const result = await response.text();

    if (category === "‡πÇ‡∏≠‡∏ô") {
      window.location.href = `/qr_page?amount=${amount}`;
    } else {
      alert(result);
      document.getElementById('amount').value = '';
      document.getElementById('note').value = '';
      document.getElementById('amount').focus();
    }
  });
</script>
